{% comment %} Load script if disquss comments are enabled and `page.comments` is either empty (index) or set to true {% endcomment %}
{% if site.disqus_short_name and page.comments != false %}
<script type="text/javascript">
  var disqus_shortname = '{{ site.disqus_short_name }}';
  {% if page.comments == true %}
  {% comment %} `page.comments` can be only be set to true on pages / posts, so we embed the comments here. {% endcomment %}
  var disqus_config = function () {
    this.page.url = '{{ site.url }}{{ page.url }}';
    this.page.identifier = '{{ site.url }}{{ page.url }}';
  };
  var disqus_script = 'embed.js';
  {% else %}
  {% comment %} As`page.comments` is empty, we must be on the index page. {% endcomment %}
  var disqus_script = 'count.js';
  {% endif %}
  (function () { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
{% endif %}